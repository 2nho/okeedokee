<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- https://mybatis.org/mybatis-3/ko/getting-started.html -->
<!-- 매핑된 SQL 구문 살펴보기에서 가져옴 -->
<mapper namespace="witness">

	<!-- 게시글 가져오기 -->
	<select id="selectWitness" parameterType="mnwVO" resultType="mnwVO">
		SELECT num, id, title, species, sex, characters, date, location, content, createdate, bdiv, isdelete, hasimg
		FROM witnesstbl
		WHERE isdelete = "N"
		ORDER BY num DESC
		LIMIT #{start}, #{count}
	</select>
	
	<!-- 게시글 토탈 카운트 -->
	<select id="selectWitnessCount" parameterType="mnwVO" resultType="int">
		SELECT COUNT(*) 
		FROM witnesstbl
		WHERE isdelete = "N"
	</select>
	
	<!-- 게시글 자세히보기 -->
	<select id="selectWitnessOne" parameterType="mnwVO" resultType="mnwVO">
		SELECT num, id, title, species, sex, characters, date, location, content, createdate, bdiv, isdelete, hasimg
		FROM witnesstbl
		WHERE isdelete = "N" AND num = #{num}
	</select>
	
	
	<!-- 게시글 추가 -->
	<insert id="insertWitness" parameterType="mnwVO" useGeneratedKeys="true" keyProperty="num">
		INSERT INTO witnesstbl(id, title, species, sex, characters, date, location, content, createdate, bdiv, hasimg)
		VALUES(#{id}, #{title}, #{species}, #{sex}, #{characters}, #{date}, #{location}, #{content}, #{createdate}, #{bdiv}, #{hasimg})
	</insert>
	
	<!-- 게시글 삭제 : isdelete만 업데이트 -->
	<delete id="deleteWitness" parameterType="mnwVO">
		UPDATE witnesstbl 
		SET isdelete = 'Y'
		WHERE num = #{num}
	</delete>
	
	<!-- 게시글 수정 -->
	<update id="updateWitness" parameterType="mnwVO">
		UPDATE witnesstbl
		SET title = #{title}, species =#{species}, sex = #{sex}, characters = #{characters}, date = #{date}, location = #{location}, content = #{content}  
		<if test="hasimg != null">, hasimg = #{hasimg}</if> 
		WHERE num = #{num} 
	</update>
	
</mapper>